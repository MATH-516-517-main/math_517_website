<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Monte Carlo Methods – MATH 517</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../resources/computing/intro_to_r/index.html" rel="next">
<link href="../notes/week_06.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Monte Carlo Methods – MATH 517">
<meta property="og:description" content="Homepage for MATH 517- Computational statistics and visualisation at EPFL, Fall 2024.">
<meta property="og:site_name" content="MATH 517">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/week_02.html">Supplementary notes</a></li><li class="breadcrumb-item"><a href="../notes/week_08.html">Monte Carlo Methods</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">MATH 517</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/MATH-517/MATH_517_website" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview/Organisation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Help &amp; FAQ</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 4</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 8</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/project-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Small project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/project-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../projects/project-tips-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tips + resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Supplementary notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exploring Data with <code>tidyverse</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kernel Density Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Non-parametric Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross-Validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EM Algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/week_08.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Monte Carlo Methods</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Coding introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/computing/intro_to_r/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/computing/intro_to_python/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/computing/intro_to_julia/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Julia</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/tutorials/github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/tutorials/github_classroom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GitHub classroom</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/tutorials/installing_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installing software</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/computing/computing-cheatsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cheatsheets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">All resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#random-number-generation" id="toc-random-number-generation" class="nav-link active" data-scroll-target="#random-number-generation">Random Number Generation</a>
  <ul class="collapse">
  <li><a href="#the-uniform-distribution-on-01" id="toc-the-uniform-distribution-on-01" class="nav-link" data-scroll-target="#the-uniform-distribution-on-01">The Uniform Distribution on <span class="math inline">\([0,1]\)</span></a></li>
  <li><a href="#other-distributions" id="toc-other-distributions" class="nav-link" data-scroll-target="#other-distributions">Other Distributions</a></li>
  <li><a href="#rejection-sampling" id="toc-rejection-sampling" class="nav-link" data-scroll-target="#rejection-sampling">Rejection Sampling</a></li>
  </ul></li>
  <li><a href="#numerical-integration" id="toc-numerical-integration" class="nav-link" data-scroll-target="#numerical-integration">Numerical Integration</a>
  <ul class="collapse">
  <li><a href="#deterministic-approaches" id="toc-deterministic-approaches" class="nav-link" data-scroll-target="#deterministic-approaches">Deterministic Approaches</a></li>
  <li><a href="#naive-monte-carlo" id="toc-naive-monte-carlo" class="nav-link" data-scroll-target="#naive-monte-carlo">Naive Monte Carlo</a></li>
  <li><a href="#importance-sampling" id="toc-importance-sampling" class="nav-link" data-scroll-target="#importance-sampling">Importance sampling</a></li>
  </ul></li>
  <li><a href="#variance-reduction" id="toc-variance-reduction" class="nav-link" data-scroll-target="#variance-reduction">Variance Reduction</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/MATH-517/MATH_517_website/edit/main/notes/week_08.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/MATH-517/MATH_517_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/week_02.html">Supplementary notes</a></li><li class="breadcrumb-item"><a href="../notes/week_08.html">Monte Carlo Methods</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Monte Carlo Methods</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Monte Carlo is an omnibus name for computational algorithms in statistics, which rely on repeated random sampling in order to produce numerical results. Major areas of use include</p>
<ul>
<li>generating draws from complicated distributions and/or on complicated domains, e.g., extremes or manifolds,</li>
<li>integral evaluation, e.g., approximations of moments, confidence intervals or high-dimensional densities in Bayesian settings, and</li>
<li>optimization, e.g., mode evaluation.</li>
</ul>
<p>But more generally, the basic idea is as follows: if we are able to generate samples from a complicated process, we can learn many things about the process with precision dictated by the amount of samples we draw. This way, we can sometimes use Monte Carlo to test hypotheses, construct confidence intervals, etc. As such, the name Monte Carlo is often used a synonym for simulation-based statistical techniques.</p>
<p><a name="MC_ex"></a> <strong>Example</strong>: Let us return to the first one from the previous lecture, where we observe a random sample <span class="math inline">\((X_1,Y_1)^\top,\ldots,(X_N,Y_N)^\top\)</span> from a bivariate Gaussian distribution <span class="math display">\[
\mathcal{N}\left(\begin{pmatrix} \mu_1 \\ \mu_2 \end{pmatrix}, \begin{pmatrix} \sigma_1^2 &amp; \rho \\ \rho &amp; \sigma_2^2 \end{pmatrix} \right)
\]</span> and wish to test <span class="math inline">\(H_0: \rho = \rho_0\)</span> for some fixed value of <span class="math inline">\(\rho_0\)</span>. If we are willing to assume that <span class="math inline">\(\rho\)</span> is the only unknown parameter (which happens, e.g., when the data come from a standardized distribution with <span class="math inline">\(\mu_1 = \mu_2 = 0\)</span> and <span class="math inline">\(\sigma_1 = \sigma_2 = 1\)</span>), we can simulate from the distribution of the empirical estimator <span class="math inline">\(\widehat{\rho} = N^{-1} \sum_{n=1}^N X_n Y_n\)</span> under the null (under the null, we know everything, and hence we can simply draw new data sets) and hence we can use this simulation to calculate the <span class="math inline">\(p\)</span>-value for our test. However, in practice, we would likely not have known the nuisance parameters <span class="math inline">\(\mu_1,\mu_2,\sigma_1,\sigma_2\)</span> (the distribution would not have been standardized) and we would have to somehow take care of them (maybe we would standardize the observed data set empirically before continuing). But how can we know whether our <span class="math inline">\(p\)</span>-value would still be valid?</p>
<p>The name Monte Carlo refers to a casino in Monaco, where an uncle of one of the method’s inventors (Stanislaw Ulam) used to loose a significant amount of money by playing roulette. With a bit of exaggeration, we could say that with every single roll (and his corresponding bet), the uncle learnt a bit more about the fact that the casino always wins in a long run. In the simple case of roulette, everything can of course be calculated directly. But with more complicated processes it can be easier to draw samples and statistically evaluate those, compared to analyzing the processes themselves.</p>
<p>The prerequisite for doing Monte Carlo is being able to draw samples from well-known distributions.</p>
<section id="random-number-generation" class="level1">
<h1>Random Number Generation</h1>
<p>For a mathematician, a <em>random number</em> is a realization of a random variable, which is a well-defined concept from measure theory. A random sample is a sequence of independent random numbers coming from the same distribution. Of course, random numbers are hard to obtain from a computer (and it is a philosophical argument whether this is even possible).</p>
<p>Historically, “randomness” was obtained using</p>
<ul>
<li>dice</li>
<li>cards</li>
<li>coins</li>
<li>physical processes</li>
<li>census data</li>
<li>tables (many created for that purpose, or drawn digits from e.g.&nbsp;logarithmic tables)</li>
</ul>
<p>A turning point came from the great <a href="https://en.wikipedia.org/wiki/John_von_Neumann">John von Neumann</a>, a father of</p>
<ul>
<li>spectral operator theory and Hilbert spaces,</li>
<li>quantum mechanics, logic, and information theory,</li>
<li>game theory and mathematical finance,</li>
<li>linear programming, and</li>
<li>simulation studies.</li>
</ul>
<p>John von Neumann advocated that sampling should <em>not be</em> random, it should only <em>appear to be</em> random by passing certain criteria (pseudo-randomness). In particular, a generated sequence should satisfy</p>
<ul>
<li>very accurate approximation to the desired distribution for <span class="math inline">\(N\to \infty\)</span>,</li>
<li>not predictable,</li>
<li>pass a set of statistical tests for independence (true independence is impossible),</li>
<li>repeatability (<span class="math inline">\(\Rightarrow\)</span> reproducibility),</li>
<li>long cycle before it starts repeating itself (today it is most commonly <span class="math inline">\(2^{31}\)</span>),</li>
<li>fast sampling (generate the sequence quickly),</li>
<li>transferability accross platforms.</li>
</ul>
<p>Today, algorithms also have to follow strict criteria set by the IEEE Arithmetic Standard. Researchers quickly set their focus specifically on generating such sequences from the uniform distribution, both due to practical reasons and due to the fact that having a good algorithm for generating random numbers from <span class="math inline">\(U[0,1]\)</span> is all one needs (other distributions can be obtained as transformations).</p>
<section id="the-uniform-distribution-on-01" class="level2">
<h2 class="anchored" data-anchor-id="the-uniform-distribution-on-01">The Uniform Distribution on <span class="math inline">\([0,1]\)</span></h2>
<p>It may be surprising that even the <em>linear congruential method</em> forming a sequence <span class="math inline">\(\{X_n\}_{n \geq 1}\)</span> by setting <span class="math display">\[ X_{n} = (a X_{n-1} + c) \,\mathrm{mod}\, m, \quad n=1,2,\ldots, \]</span> where <span class="math inline">\(a,c,m\)</span> and <span class="math inline">\(X_0\)</span> are cleverly chosen to fulfill the requirements above. The linear congruential method will naturally produce only a finite sequence of numbers before starting to repeat itself. A length of such sequence, known as the period, can however be very large (e.g.&nbsp;<span class="math inline">\(10^{12}\)</span>) depending on the choice of the constants, so this is hardly a practical problem. Random numbers between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> can then be derived as <span class="math inline">\(X_n/m\)</span>.</p>
<p>Actually, the fact that a sequence of numbers appears to be random even though every number in the sequence is a deterministic function of the previous number(s) has one huge advantage: reproducibility. Even though the linear congruential method in its simplest form above is not used, one can think of setting the seed (by <code>set.seed()</code> in <code>R</code>) as choosing the staring point (<span class="math inline">\(X_0\)</span>) in the finite sequence produced by the linear congruential method, from which a sub-sequence (the random sample of length <span class="math inline">\(N\)</span> is sampled). At any later point in time, the same sub-sequence can be obtained by using the same generator starting from the same starting point.</p>
<p>While it is beyond the scope of this course to dive any deeper into the base-line pseudo-RNG algorithms, we should keep several points in mind:</p>
<ul>
<li>RNG used in statistics is only <em>pseudo-random</em>, i.e., it appears to be random, even though it is fully deterministic.</li>
<li>RNG algorithms are constantly improving. Now, we believe to have a “perfect” algorithm for our purposes provided with our software.</li>
</ul>
<!-- * However, when working with some older software (even older versions of `R` or Matlab), one should be vigilant. (I saw once, in an old version of Matlab, a "pseudo-random" sequence $X_1,\ldots,X_N$ such that the subsequent triplets $(X_1,X_2,X_3)^\top, (X_4,X_5,X_6)^\top, \ldots \in \mathbb{R}^3$ actually laid on a line in $\mathbb{R}^3$.) -->
<!-- ```{r,fig.width=12,fig.height=4} -->
<!-- Nsim=10^4 #number of random numbers -->
<!-- x=runif(Nsim) -->
<!-- x1=x[-Nsim] #vectors to plot -->
<!-- x2=x[-1] #adjacent pairs -->
<!-- par(mfrow=c(1,3)) -->
<!-- hist(x,main="Histogram") -->
<!-- plot(x1,x2, main="Scatterplot") -->
<!-- acf(x, "Autocovariance Function") -->
<!-- ``` -->
</section>
<section id="other-distributions" class="level2">
<h2 class="anchored" data-anchor-id="other-distributions">Other Distributions</h2>
<p>Now that we know how to generate data from the <span class="math inline">\(\mathcal{U}(0,1)\)</span> distribution (at least for most practical purposes), we can formally use the following result to generate data from any other distribution.</p>
<p><strong>Lemma.</strong> <em>(Inverse transform.)</em> Let <span class="math inline">\(U \sim \mathcal{U}(0,1)\)</span>. Then, for a distribution function <span class="math inline">\(F\)</span>, the random variable <span class="math inline">\(X = F^{-1}(U)\)</span> has distribution <span class="math inline">\(F\)</span>.</p>
<p><strong>Proof.</strong> Simply <span class="math inline">\(P(X \leq x) = P\{F(X) \leq F(x)\} = P\{U \leq F(x)\} = F(x)\)</span>.</p>
<p>The lemma above silently assumes existence of the inverse <span class="math inline">\(F^{-1}\)</span>, but the inverse can be replaced by the generalized inverse <span class="math inline">\(F^-(y) = \inf\{x \,|\, F(x) \geq y\}\)</span>, and the proof is just slightly more complicated.</p>
<p>While the theorem above seems almighty, it is not. For instance, to generate from <span class="math inline">\(\mathcal{N}(0,1)\)</span>, we would need to work with the distribution function of standard normal, which does not have an analytic expression, hence numerical approximation is needed again. Software usually has built-in functions for standard distributions, and they should be used, e.g., <code>rnorm()</code> to generate from <span class="math inline">\(N(0,1)\)</span>, and those are often based on more simple and efficient transformation relationships between distributions, e.g., <span class="math inline">\(a X + b \sim \mathcal{N}(b,a^2)\)</span> for <span class="math inline">\(X \sim \mathcal{N}(0,1)\)</span>. Many other examples are shown on <a href="http://www.math.wm.edu/~leemis/chart/UDR/UDR.html">this diagram</a>, e.g., the standard uniform distribution can be transformed to the exponential distribution from which Laplace, Weibull, Gamma, or Chi-squared distributions can be easily obtained. Looking carefully at the diagram, one can notice that an important path is missing: the generation of <span class="math inline">\(\mathcal{N}(0,1)\)</span> from <span class="math inline">\(\mathcal{U}(0,1)\)</span>. This can be achieved, e.g., by using the Box-Muller transform.</p>
<p><strong>Lemma.</strong> <em>(Box-Muller transform.)</em> Let <span class="math inline">\(U_1,U_2 \sim \mathcal{U}(0,1)\)</span> be independent. Then <span class="math display">\[
Z_1 = \sqrt{-2 \log(U_1)} \cos(2\pi U_2) \quad \&amp; \quad Z_2 = \sqrt{-2 \log(U_1)} \sin(2\pi U_2)
\]</span> are two independent standard Gaussian random variables.</p>
<p><strong>Proof.</strong> Calculation based on the density transformation theorem and on deriving the distribution of the polar coordinates of <span class="math inline">\((Z_1,Z_2)\)</span>.</p>
<p>The Box-Muller transform is easy to be implemented, but it may not be the best way to generate from the standard Gaussian since evaluating trigonometric functions is rather expensive.</p>
</section>
<section id="rejection-sampling" class="level2">
<h2 class="anchored" data-anchor-id="rejection-sampling">Rejection Sampling</h2>
<p>Assume we wish to simulate from a <em>target</em> density <span class="math inline">\(f\)</span> and we know how to simulate from a <em>proposal</em> density <span class="math inline">\(g\)</span>. Assume the support of <span class="math inline">\(f\)</span> is included in that of <span class="math inline">\(g\)</span>, i.e., <span class="math inline">\(\forall x: f(x) &gt; 0 \Rightarrow g(x) &gt; 0\)</span>, and there exists <span class="math inline">\(c &gt; 1\)</span> such that <span class="math inline">\(\forall x : f(x) \leq c g(x)\)</span>, i.e., <span class="math inline">\(\underset{x}{\sup} \frac{f(x)}{g(x)}=c &lt; \infty\)</span>. Here, the assumption on the support can/should be relaxed by assuming that the support of the target density <span class="math inline">\(f\)</span> is contained in that of <span class="math inline">\(g\)</span>. The following algorithm can then be used to draw a sample <span class="math inline">\(X\)</span> from <span class="math inline">\(f\)</span>:</p>
<ol type="1">
<li>Draw a proposal <span class="math inline">\(Y\)</span> from <span class="math inline">\(g\)</span>.</li>
<li>Draw <span class="math inline">\(U \sim \mathcal{U}(0,1)\)</span>.</li>
<li>If <span class="math inline">\(U  \leq \frac{1}{c} \frac{f(Y)}{g(Y)}\)</span>, accept <span class="math inline">\(X = Y\)</span> and stop, otherwise go back to 1.</li>
</ol>
<p>In the example of the standard uniform proposal and the beta <span class="math inline">\(\mathcal{B}(2,5)\)</span> target below, it is easy to see that the algorithm works (really generates from the target <span class="math inline">\(f\)</span>) and that the probability of stopping in step 3 (the acceptance probability) of the algorithm above is equal to <span class="math inline">\(1/c\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>The acceptance probability is clear even more generally, since we sample the uniform pair <span class="math inline">\((Y,U)\)</span> from a mass <span class="math inline">\(M\)</span> (the area under <span class="math inline">\(M g(x)\)</span>) and accept iff the sample hits the area under <span class="math inline">\(f(x)\)</span>, which is one. For validity of the algorithm, note that the outcome <span class="math inline">\(X\)</span> of the algorithm is really distributed according to <span class="math inline">\(f\)</span>: <span class="math display">\[
\begin{split}
P(X \leq x) &amp;= P\Bigg\lbrace Y \leq x \,\Bigg|\, U \leq \underbrace{\frac{1}{c} \frac{f(Y)}{g(Y)}}_{=:t(Y)} \Bigg\rbrace
= \frac{P\lbrace Y \leq x \,\wedge\, U \leq t(Y) \rbrace}{P\lbrace U \leq t(Y) \rbrace}\\
&amp;= \frac{\int_{-\infty}^x \int_{0}^{t(y)}d u\, g(y) d y}{\int_{-\infty}^{+\infty} \int_{0}^{t(y)}d u\, g(y) d y}
= \frac{\int_{-\infty}^x t(y) g(y) d y}{\int_{-\infty}^{+\infty} t(y) g(y) d y} = \frac{\int_{-\infty}^x \frac{1}{c} f(y) d y}{\int_{-\infty}^{+\infty} \frac{1}{c} f(y) d y} =\frac{\frac{1}{c} F(x)}{\frac{1}{c}} = F(x),
\end{split}
\]</span> where <span class="math inline">\(F\)</span> is the distribution function corresponding to the density <span class="math inline">\(f\)</span>.</p>
<p>Similarly to the inverse transform method, rejection sampling is quite general and can be used to sample from virtually all distributions (for discrete distributions, one can work with probability mass functions instead of densities; multivariate distributions can be treated the same), as long as a proposal density can be found. However, it’s efficiency is dictated by how efficiently the target and proposal densities can be evaluated and how high is the acceptance probability <span class="math inline">\(P\lbrace U \leq t(Y) \rbrace=1/c\)</span> (basically we want the target and proposal densities to have a similar shape in order to have a low constant <span class="math inline">\(c \approx 1\)</span>.</p>
<p><strong>Example:</strong> We wish to simulate data from the standard Gaussian target using the doubly exponential proposal, i.e., <span class="math display">\[
f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \quad \&amp; \quad g(x) = \frac{\alpha}{2} e^{-\alpha |x|}, \text{ where } \alpha &gt; 0, \quad x \in \mathbb{R}
\]</span></p>
<p>In the code below, I use <code>M</code> in place of <span class="math inline">\(c\)</span>, since <code>c</code> is sacred in <code>R</code>. The rate of the doubly exponential proposal is set at 1 as it minimizes the value of <span class="math inline">\(c=\sup f(x)/g(x)\)</span> and hence maximizes the acceptance probability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">optimize</span>(<span class="at">f=</span><span class="cf">function</span>(x){<span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">dexp</span>(<span class="fu">abs</span>(x))<span class="sc">*</span><span class="dv">2</span>}, <span class="at">interval=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">maximum=</span>T)<span class="sc">$</span>objective</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a single accepted sample from standard doubly exp. proposal and N(0,1) target</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>acc_rej_dexp_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(M,a,b){</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span>M</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  signs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sample</span>(signs,<span class="dv">1</span>) <span class="co"># doubly exponential</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (U<span class="sc">&gt;</span><span class="fu">dnorm</span>(Y)<span class="sc">/</span><span class="fu">dexp</span>(<span class="fu">abs</span>(Y))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>M){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span>M</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sample</span>(signs,<span class="dv">1</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Y)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span><span class="sc">/</span><span class="dv">1001</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(x),x),M<span class="sc">*</span><span class="fu">c</span>(<span class="fu">rev</span>(<span class="fu">dexp</span>(x))<span class="sc">/</span><span class="dv">2</span>,<span class="fu">dexp</span>(x)<span class="sc">/</span><span class="dv">2</span>),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">xlab=</span><span class="st">""</span>,<span class="at">ylab=</span><span class="st">""</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Target and scaled proposal densities"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(x),x),<span class="fu">c</span>(<span class="fu">rev</span>(<span class="fu">dnorm</span>(x)),<span class="fu">dnorm</span>(x)),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">517</span>)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  X[n] <span class="ot">&lt;-</span> <span class="fu">acc_rej_dexp_norm</span>(M,a,b)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(X),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">main=</span><span class="st">"KDE plots from simulated data"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(N)),<span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>The example above provides another way of generating from the standard Gaussian: <span class="math display">\[
\mathcal{U}[0,1] \longrightarrow Exp(1) \longrightarrow DoublyExp(1) \longrightarrow N(0,1)
\]</span> where the arrows correspond to transformations:</p>
<ul>
<li>first arrow is a log-transform,</li>
<li>second arrow is simple, see the code above,</li>
<li>third arrow is the rejection algorithm above.</li>
</ul>
<p><code>R</code> actually uses neither Box-Muller nor the rejection approach from the doubly exponential proposal. Instead it uses the inverse transform, searching through the values of <span class="math inline">\(F^{-1}\)</span>, which are tabulated to a very high precision in the case of standard Gaussian.</p>
</section>
</section>
<section id="numerical-integration" class="level1">
<h1>Numerical Integration</h1>
<section id="deterministic-approaches" class="level2">
<h2 class="anchored" data-anchor-id="deterministic-approaches">Deterministic Approaches</h2>
<p>Numerical integration (of definite integrals) is an important problem and constitutes a large area of research. The most well-known and simplest deterministic method, called the <em>quadrature</em> method, amounts to calculating Riemann sums, i.e., evaluating the function on a grid <span class="math inline">\(t_1,\ldots,t_K\)</span> and approximating <span class="math display">\[
I = \int_a^b f(x) d x
\]</span> by <span class="math inline">\(S_K = \{(b-a)/K\} \sum_{k=1}^K f(t_k)\)</span>. As <span class="math inline">\(K\to \infty\)</span>, <span class="math inline">\(S_K \to I\)</span> (for a reasonable <span class="math inline">\(f\)</span>). Actually, the formula for <span class="math inline">\(S_K\)</span> above corresponds to integrating locally constant interpolation of <span class="math inline">\(f\)</span> based on <span class="math inline">\(f(t_1),\ldots,f(t_K)\)</span>. Of course, we can do smarter than local constant:</p>
<ul>
<li>local linear interpolation leads to the <em>trapezoidal rule</em>,</li>
<li>local quadratic interpolation leads to the <em>Simpson’s rule</em>.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/numerical_integration/local_constant_rule.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Figure: Riemann sum, trapezoidal rule, and Simpson’s rule. Simpson’s rule is missing the grid, sorry about that – imagine that there is the same grid as on the first two plots, and the function is approximated quadratically between every two neighboring grid points. Source: wiki.</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/numerical_integration/local_linear_rule.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Figure: Riemann sum, trapezoidal rule, and Simpson’s rule. Simpson’s rule is missing the grid, sorry about that – imagine that there is the same grid as on the first two plots, and the function is approximated quadratically between every two neighboring grid points. Source: wiki.</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/numerical_integration/local_quadratic_rule.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Figure: Riemann sum, trapezoidal rule, and Simpson’s rule. Simpson’s rule is missing the grid, sorry about that – imagine that there is the same grid as on the first two plots, and the function is approximated quadratically between every two neighboring grid points. Source: wiki.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="naive-monte-carlo" class="level2">
<h2 class="anchored" data-anchor-id="naive-monte-carlo">Naive Monte Carlo</h2>
<p>The naive Monte Carlo basically replaces the deterministic grid with a random one: <span class="math inline">\(N\)</span> samples <span class="math inline">\(X_1,\ldots,X_N\)</span> are drawn from <span class="math inline">\(\mathcal{U}[a,b]\)</span> distribution and <span class="math display">\[
I = (b-a) \mathbb{E}\big\lbrace f(U) \big\rbrace
\]</span> is approximated stochastically by <span class="math inline">\(\widehat{I}_N = (b-a) N^{-1} \sum_{n=1}^N f(X_n)\)</span>. Due to the law of large numbers, <span class="math inline">\(\widehat{I}_N \to I\)</span> almost surely. Compared to the deterministic approaches, Monte Carlo has the advantage of easy convergence monitoring: <span class="math inline">\(\widehat{I}_N\)</span> is a random variable arising as a mean of i.i.d. random variables. It is unbiased and its variance can be naturally estimated as <span class="math inline">\(v_n\)</span> below. Hence by the central limit theorem we have <span class="math display">\[
\sqrt{N}\frac{\widehat{I}_N - I}{v_N} \stackrel{\cdot}{\sim} \mathcal{N}(0,1) \,, \quad \text{where} \quad v^2_N = \frac{1}{N} \sum_{n=1}^N \big[ f(X_n) - \bar{f}_N \big]^2
\]</span> from which confidence intervals can be constructed and convergence checked, provided the variance exists and converges fast enough (which is not always the case). Although constructions of CIs this way is often very useful, one has to be careful about <em>silent failure</em>. When, e.g., <span class="math inline">\(f\)</span> explodes on a very small sub-interval of <span class="math inline">\([a,b]\)</span> and we have no samples on this sub-interval, the CIs will be overly optimistic. Basically if the sampling regime misses an important pattern, the variance estimate and hence CI will miss it too, so we may be overly confident in a wrong result.</p>
<p>There are other problems with the simple approaches above. They struggle with unbounded domains (often failing to find the important areas) and they are prone to the curse of dimensionality in the case of multivariate integrals. Both of these are quite common in statistics.</p>
</section>
<section id="importance-sampling" class="level2">
<h2 class="anchored" data-anchor-id="importance-sampling">Importance sampling</h2>
<p>The typical situation in which Monte Carlo overcomes the aforementioned problems and outshines deterministic approaches is when sampling can be custom-tailored to the integrand. We can write <span class="math display">\[
I := \int_\mathcal{X} f(x) d x = \int_\mathcal{X} \frac{f(x)}{g(x)} g(x) d x =
\mathbb{E}_g \left\lbrace \frac{f(X)}{g(X)} \right\rbrace.
\]</span> Now sampling <span class="math inline">\(X_1,\ldots,X_N \sim g\)</span>, we can approximate <span class="math inline">\(I\)</span> by <span class="math display">\[
\widehat{I} := \frac{1}{N}\sum_{n=1}^N \frac{f(X)}{g(X)}.
\]</span> We still have from the law of large numbers that <span class="math inline">\(\widehat{I} \stackrel{a.s.}{\to} I\)</span> and can construct CIs from the limiting distribution provided by CLT. Notice that the asymptotic variance of <span class="math inline">\(\widehat{I}\)</span> is <span class="math display">\[
\mathrm{AVar}\big(\widehat{I}\big) = \frac{1}{N} \int_\mathcal{X} \left[ \frac{f(x)}{g(x)} -  \mathbb{E}_g \left\lbrace \frac{f(X)}{g(X)} \right\rbrace \right]^2 g(x) d x.
\]</span> In particular, the variance is zero if <span class="math inline">\(f(x)/g(x) = 1\)</span> on the domain <span class="math inline">\(\mathcal{X}\)</span>, and is small if <span class="math inline">\(f/g\)</span> is approximately constant on <span class="math inline">\(\mathcal{X}\)</span>.</p>
<p>Intuitively, if we integrate a very flat function, i.e., if all regions of the domain are of equal importance, very few samples suffice to have a good approximation. This is of course true also for the deterministic approaches. But the great advantage of Monte Carlo is that we can incorporate different importance of different regions of the domain into the sampling scheme (and hence the name <em>importance sampling</em>).</p>
<p>In statistical applications, we are often interested directly in the integrals of the form <span class="math display">\[
\mathbb{E}_g \big\lbrace f(X) \big\rbrace = \int_\mathcal{X} f(x) g(x) d x
\]</span> and if simulation from <span class="math inline">\(g\)</span> is readily available, we can proceed as above. If simulation from <span class="math inline">\(g\)</span> is difficult, we can change the reference (probability) measure from <span class="math inline">\(g\)</span> to some <span class="math inline">\(h\)</span> <span class="math display">\[
\mathbb{E}_g \big\lbrace f(X) \big\rbrace = \int_\mathcal{X} f(x) \frac{g(x)}{h(x)} h(x) d x = \mathbb{E}_h \left\lbrace f(X) \frac{g(X)}{h(X)} \right\rbrace
\]</span> and simulate from <span class="math inline">\(h\)</span> instead.</p>
<p>Hence we have a lot of freedom in how to sample (i.e., how to choose the reference measure), but there is a certain trade-off: we want to</p>
<ul>
<li>have the integrand as flat as possible</li>
<li>be able to simulate from the reference measure efficiently</li>
</ul>
<p>When <span class="math inline">\(\mathcal{X} = \mathbb{R}\)</span>, it is important to match the decay of the tails between the target and reference measures. This is the case for both rejection and importance sampling schemes, and it makes them practically not that useful in more complicated examples (where the tail behavior might not even be known).</p>
<p><em>Note</em>: We also have to be careful when changing measure to always cover the whole domain <span class="math inline">\(\mathcal{X}\)</span>; we cannot use, e.g., <span class="math inline">\(\mathcal{U}[a,b]\)</span> as the new reference measure when <span class="math inline">\(\mathcal{X} = \mathbb{R}\)</span>. Typically (as shown in the examples below), we are in the opposite situation: we typically have means to sample from a larger domain than <span class="math inline">\(\mathcal{X}\)</span>, and samples outside of <span class="math inline">\(\mathcal{X}\)</span> are rejected. Be careful about standardization of your results in that case.</p>
<p><strong>Example:</strong> Approximately calculate <span class="math inline">\(P(2 &lt; X &lt; 6)\)</span> for the target distribution <span class="math inline">\(X \sim f\)</span> using a reference <span class="math inline">\(g\)</span> for</p>
<ul>
<li>Gaussian target, Exponential Reference</li>
<li>Cauchy target, Exponential Reference</li>
<li>Cauchy target, Gaussian Reference</li>
</ul>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">ps=</span><span class="dv">30</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1001</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,<span class="fu">dexp</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">dexp</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">696</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rexp</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>wein<span class="ot">=</span><span class="fu">dnorm</span>(x)<span class="sc">/</span><span class="fu">dexp</span>(x)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(wein/sum(wein))</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>),<span class="fu">cumsum</span>(wein<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">6</span>))<span class="sc">/</span><span class="fu">cumsum</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>),<span class="at">xlab=</span><span class="st">"log(N)"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">pnorm</span>(<span class="dv">6</span>)<span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">2</span>),<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">"sienna"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="3" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Ratio of densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Importance sampling error</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p>Gaussian target, Exponential reference</p>
</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">ps=</span><span class="dv">30</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1001</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dcauchy</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,<span class="fu">dexp</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dcauchy</span>(x)<span class="sc">/</span><span class="fu">dexp</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">696</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rexp</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>wein<span class="ot">=</span><span class="fu">dcauchy</span>(x)<span class="sc">/</span><span class="fu">dexp</span>(x)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(wein/sum(wein))</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>),<span class="fu">cumsum</span>(wein<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">6</span>))<span class="sc">/</span><span class="fu">cumsum</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">xlab=</span><span class="st">"log(N)"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">pcauchy</span>(<span class="dv">6</span>)<span class="sc">-</span><span class="fu">pcauchy</span>(<span class="dv">2</span>),<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">"sienna"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="3" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Ratio of densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Importance sampling error</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p>Cauchy target, Exponential reference</p>
</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">ps=</span><span class="dv">30</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)<span class="sc">/</span><span class="dv">1001</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dcauchy</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,<span class="fu">dnorm</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dcauchy</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">491</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>wein<span class="ot">=</span><span class="fu">dcauchy</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(wein/sum(wein))</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>),<span class="fu">cumsum</span>(wein<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">6</span>))<span class="sc">/</span><span class="fu">cumsum</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>)),<span class="at">type=</span><span class="st">"l"</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.3</span>),<span class="at">xlab=</span><span class="st">"log(N)"</span>,<span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">pcauchy</span>(<span class="dv">6</span>)<span class="sc">-</span><span class="fu">pcauchy</span>(<span class="dv">2</span>),<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">"sienna"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="3" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Ratio of densities</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week_08_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>Importance sampling error</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p>Cauchy target, Gaussian reference</p>
</div>
</div>
</div>
</section>
</section>
<section id="variance-reduction" class="level1">
<h1>Variance Reduction</h1>
<p>As exemplified above in the case of importance sampling, accuracy of Monte Carlo integration can be assessed by the asymptotic variance (the theoretical one). One of the clear advantages of Monte Carlo integration is that this variance can be estimated by its sample version, which gives us some information about how confident we can be in the obtained results, and hence gives us the means to decide when to stop simulating (iterating) and be satisfied with our current result. The choice of the proposal function should be such that the asymptotic variance is as small as possible. This is just one (though clearly the most important, at least for statistics) example of a variance reduction technique. Other variance reduction techniques include</p>
<ul>
<li>control variates
<ul>
<li>Example: Say we want to estimate <span class="math inline">\(\mathbb{E}(Z)\)</span> with <span class="math inline">\(Z = X - Y\)</span>. If this is not the case, you can still write <span class="math inline">\(Z=(Z+Y)-Y\)</span>, and <span class="math inline">\(Y\)</span> plays the role of the control variate and should be chosen such that it is correlated with <span class="math inline">\(Z\)</span>.</li>
</ul>
We can sample independently <span class="math inline">\(X_1,\ldots,X_N\)</span> and <span class="math inline">\(Y_1,\ldots,Y_N\)</span>, form <span class="math inline">\(Z_n = X_n - Y_n\)</span> for <span class="math inline">\(n=1,\ldots,N\)</span>, and estimate <span class="math inline">\(\mathbb{E}(Z)\)</span> empirically as <span class="math inline">\(N^{-1} \sum Z_n\)</span>. The variance of this estimator is governed by <span class="math inline">\(\mathrm{var}(Z_n) = \mathrm{var}(X_n) + \mathrm{var}(Y_n) - 2 \mathrm{cov}(X_n,Y_n)\)</span>, where the covariance is normally 0 since the <span class="math inline">\(X\)</span>’s and <span class="math inline">\(Y\)</span>’s are drawn independently. Instead, if we alter the sampling such that <span class="math inline">\(\mathrm{cov}(X_n,Y_n) &gt; 0\)</span>, we reduce the sampling variance of our estimator. This is what happens when <span class="math inline">\(X\)</span> is equal to <span class="math inline">\(Z+Y\)</span>.</li>
<li>quasi-random sampling
<ul>
<li>Example: Say we wish to approximate <span class="math inline">\(\int_0^1 f(x) d x\)</span>.</li>
</ul>
Instead of sampling <span class="math inline">\(X_1,\ldots, X_N\)</span> uniformly on <span class="math inline">\((0,1)\)</span>, we could take a regular grid <span class="math inline">\(t_1,\ldots,t_K\)</span> and introduce randomness by taking <span class="math inline">\(X_{k,j} := t_k + U_j \text{ mod } 1\)</span> where the <span class="math inline">\(U\)</span>’s are sampled uniformly on <span class="math inline">\((0,1)\)</span>. The resulting points are more equally spread out and the empirical estimator based on locations <span class="math inline">\(X_{k,j}\)</span> can have reduced variance.
<ul>
<li>The example above is an oversimplification, in practice different quasi-random sequences are used (e.g., the <a href="https://en.wikipedia.org/wiki/Sobol_sequence">Sobol sequence</a>), which are guaranteed to result in faster convergence rates, depending on the smoothness of <span class="math inline">\(f\)</span>.</li>
</ul></li>
<li>and many other techniques such as, antithetic variables, or multi-level sampling.</li>
</ul>
<p>The take-home message of the control variate example above is that when comparing several different estimators/methods via simulations, the same simulated data sets should be used for all the estimators/methods. For example, assume we are performing a small simulation study to assess which of two location estimators is better for a sample <span class="math inline">\(W_1,\ldots,W_N \sim \mathcal{N}(\mu,1)\)</span>: <span class="math display">\[
\widehat{\mu}_1 = \frac{1}{N}\sum_{n=1}^N W_n \quad \text{or} \quad \widehat{\mu}_2 = \frac{1}{\sum_{n=1}^N \mathbb{I}_{\{|W_n| \leq 3\}}}\sum_{n=1}^N W_n \mathbb{I}_{\{|W_n| \leq 3\}},
\]</span> i.e., the first estimator is the standard empirical mean, while the second estimator discards outliers and calculates empirical average of the remaining data points. Of course, we know that the empirical mean is a superior estimator in this case (at least w.r.t. the squared loss, since the data are assumed Gaussian), but how do we verify it via simulations? For different values of <span class="math inline">\(\mu\)</span> and for <span class="math inline">\(b=1,\ldots,B\)</span>, we generate a data set <span class="math inline">\(W_1^b,\ldots,W_N^b\)</span>, calculate the estimators, and then calculate the loss of the estimators. Schematically: <span class="math display">\[
\begin{eqnarray}
W_1^b,\ldots,W_N^b &amp;\Rightarrow&amp; \widehat{\mu}_1^b \Rightarrow X_b &amp;=&amp; ( \widehat{\mu}_1^b - \mu)^2 \\
W_1^b,\ldots,W_N^b &amp;\Rightarrow&amp; \widehat{\mu}_2^b \Rightarrow \,Y_b &amp;=&amp; ( \widehat{\mu}_2^b - \mu)^2
\end{eqnarray}
\]</span> Notice how in every simulation, we drew only one sample. We didn’t even think of generating <span class="math inline">\(\widetilde W_1^b,\ldots,\widetilde W_N^b\)</span> independent of <span class="math inline">\(W_1^b,\ldots,W_N^b\)</span> and using the following scheme: <span class="math display">\[
\begin{eqnarray}
\widetilde W_1^b,\ldots,W_N^b &amp;\Rightarrow&amp; \widehat{\mu}_1^b \Rightarrow X_b &amp;=&amp; ( \widehat{\mu}_1^b - \mu)^2 \\
\widetilde W_1^b,\ldots,W_N^b &amp;\Rightarrow&amp; \widehat{\mu}_2^b \Rightarrow \,Y_b &amp;=&amp; ( \widehat{\mu}_2^b - \mu)^2 .
\end{eqnarray}
\]</span> While generating two different samples in every simulation run would also work, it would introduce an unnecessary variability into our simulation and increase the variance of <span class="math inline">\(Z_b = X_b - Y_b\)</span> (which is ultimately the variable we are interested in - we want to know whether <span class="math inline">\(\mathbb{E}(Z_b)\)</span> is smaller or greater than 0), because clearly <span class="math inline">\(\mathrm{cov}(X_b,Y_b) &gt; 0\)</span>. But it could be the other way around with different estimators. For example, consider replacing <span class="math inline">\(\widehat{\mu}_2\)</span> by <span class="math display">\[
\widehat{\mu}_2 = \frac{1}{\sum_{n=1}^N \mathbb{I}_{\{|W_n| &gt; 3\}}}\sum_{n=1}^N W_n \mathbb{I}_{\{|W_n| &gt; 3\}}.
\]</span> Then, it should intuitively be <span class="math inline">\(\mathrm{cov}(X_b,Y_b) &lt; 0\)</span> (because <span class="math inline">\(\widehat{\mu}_1\)</span> performs well when there is few outliers, while <span class="math inline">\(\widehat{\mu}_2\)</span> would perform well with many outliers). Thus, it would probably be better to evaluate the estimators on independent samples. However, the latter <span class="math inline">\(\widehat{\mu}_2\)</span> is a poor estimator. Usually, the correlation between estimators is positive and we should always evaluate different methods on the same data.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Donald Knuth (1997, 3rd ed.) <em>The Art of Computer Programming</em>, volume 2</p>
<p>Robert &amp; Casella (2010) <em>Introducing Monte Carlo methods with R</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/math-517\.github\.io\/math_517_website\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/week_06.html" class="pagination-link" aria-label="EM Algorithm">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">EM Algorithm</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../resources/computing/intro_to_r/index.html" class="pagination-link" aria-label="R">
        <span class="nav-page-text">R</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Charles Dufour and Linda Mhalla</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/MATH-517/MATH_517_website/edit/main/notes/week_08.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/MATH-517/MATH_517_website/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>